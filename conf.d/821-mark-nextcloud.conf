filter {
  if [type] == "apache_access" and [syslog][identifier] == "nextcloud" {
    mutate {
      add_field => { "application" => "nextcloud" }
    } 
    if [http][verb] == "OPTIONS" {
      mutate {
        add_tag => [ "Known Message", "Benign" ] 
      }
    } else if [http][response][code] == 401 and [http][request][path] =~ /^\/nextcloud\/remote\.php\// { 
      mutate {
        add_tag => [ "Known Message" ]
      }
    } else if [http][response][code] == 404 and [http][request][path] =~ /^\/nextcloud\/index\.php\/core\/preview\.png\?/ {
      mutate {
        add_tag => [ "Known Message", "Benign" ]
      }
    } else if [http][response][code] and [http][response][code] < 400  {

      if [http][request][path] =~ /^\/apps\// {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_NC_ROOT}apps/%{NOTSPACE}/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/activity/api/v2/activity/filter$",
            "^%{SITE_NC_ROOT}apps/activity/css/(settings|style)\.css$",
            "^%{SITE_NC_ROOT}apps/activity/img/(activity(-dark)?|(add|delete)-color|change)\.svg$",
            "^%{SITE_NC_ROOT}apps/activity/js/(feedSettings|filesplugin|formatter|richObjectStringParser|settings|script)\.js$",
            "^%{SITE_NC_ROOT}apps/activity/js/activity(collection|model|tabview)\.js$",
            "^%{SITE_NC_ROOT}apps/announcementcenter/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/announcementcenter/img/announcementcenter\.svg$",
            "^%{SITE_NC_ROOT}apps/announcementcenter/js/script\.js$",
            "^%{SITE_NC_ROOT}apps/audioplayer/$",
            "^%{SITE_NC_ROOT}apps/audioplayer/(get(audiostream|category(items)?|cover|importtpl|music|progress|value)|resetmedialibrary|scanforaudiofiles|set(statistics|value))$",
            "^%{SITE_NC_ROOT}apps/audioplayer/css/(bar-ui|jquery\.Jcrop|style)\.css$",
            "^%{SITE_NC_ROOT}apps/audioplayer/css/(bar-ui|style)-min\.css$",
            "^%{SITE_NC_ROOT}apps/audioplayer/css/3rdparty/fontello/css/(animation|fontello)\.css$",
            "^%{SITE_NC_ROOT}apps/audioplayer/css/3rdparty/fontello/font/fontello\.woff$",
            "^%{SITE_NC_ROOT}apps/audioplayer/img/albums\.svg$",
            "^%{SITE_NC_ROOT}apps/audioplayer/img/bar-ui/(next|pause|play|previous|repeat|shuffle|spinner|volume)\.svg$",
            "^%{SITE_NC_ROOT}apps/audioplayer/img/icomoon/entypo-25px-000000/SVG/(shuffle|volume)\.svg$",
            "^%{SITE_NC_ROOT}apps/audioplayer/img/icomoon/free-25px-000000/SVG/spinner\.svg$",
            "^%{SITE_NC_ROOT}apps/audioplayer/img/oc/(play-(big|next|previous)|repeat)\.svg$",
            "^%{SITE_NC_ROOT}apps/audioplayer/js/(app(-min)?|bar-ui(-min)?|jquery\.Jcrop|settings|sidebar|viewer)\.js$",
            "^%{SITE_NC_ROOT}apps/audioplayer/js/soundmanager2-nodebug-jsmin\.js$",
            "^%{SITE_NC_ROOT}apps/audioplayer/js/viewer/viewer\.js$",
            "^%{SITE_NC_ROOT}apps/bookmarks(/(bookmark|tag)?)?$",
            "^%{SITE_NC_ROOT}apps/bookmarks/css/3rdparty/jquery\.tagit\.css$",
            "^%{SITE_NC_ROOT}apps/bookmarks/css/bookmarks\.css$",
            "^%{SITE_NC_ROOT}apps/bookmarks/css/select2\.css$",
            "^%{SITE_NC_ROOT}apps/bookmarks/img/bookmarks\.svg$",
            "^%{SITE_NC_ROOT}apps/bookmarks/js/(bookmarks|settings|viewer)\.js$",
            "^%{SITE_NC_ROOT}apps/bookmarks/js/3rdparty/(js_tpl|tag-it)\.js$",
            "^%{SITE_NC_ROOT}apps/bookmarks/js/dist/main\.bundle\.js$",
            "^%{SITE_NC_ROOT}apps/c(ontacts|alendar)/js/loader\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/$",
            "^%{SITE_NC_ROOT}apps/calendar/3rdparty/chosen/(cs|j)s/chosen(\.jquery\.min)?\.(css|js)$",
            "^%{SITE_NC_ROOT}apps/calendar/3rdparty/fullcalendar/(cs|j)s/fullcalendar\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/calendar/3rdparty/jquery\.multiselect/(cs|j)s/jquery\.multiselect\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/calendar/3rdparty/jsTz/jstz-[\d.]+\.min\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/3rdparty/miniColors/(cs|j)s/jquery\.miniColors\.(min\.)?(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/calendar/3rdparty/timepicker/(cs|j)s/jquery\.ui\.timepicker\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/calendar/css/(calendar(list)?|datepicker|eventdialog|globals|settings|share|style)\.css$",
            "^%{SITE_NC_ROOT}apps/calendar/css/public/(app|vendor\.min)\.css$",
            "^%{SITE_NC_ROOT}apps/calendar/img/(calendar|(left|right)arrow)\.svg$",
            "^%{SITE_NC_ROOT}apps/calendar/img/favicon\.ico$",
            "^%{SITE_NC_ROOT}apps/calendar/js/(calendar|on-event|settings|share|jquery\.multi-autocomplete).js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/public/(app|vendor)(\.min)?\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/angular-bootstrap/ui-bootstrap(-tpls)?\.min\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/angular-route/angular-route\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/angular-ui-calendar/src/calendar\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/angular/angular\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/davclient\.js/lib/client\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/fullcalendar/dist/fullcalendar\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/fullcalendar/dist/lang-all\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/ical\.js/build/ical\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/jquery-timepicker/jquery\.ui\.timepicker\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/calendar/js/vendor/jstzdetect/jstz\.min\.js$",
            "^%{SITE_NC_ROOT}apps/calendar/templates/colorpicker\.html$",
            "^%{SITE_NC_ROOT}apps/calendar/v1/config$",
            "^%{SITE_NC_ROOT}apps/calendar/v1/timezones/%{NOTSPACE}\.ics$",
            "^%{SITE_NC_ROOT}apps/checksum/js/checksum\.(plugin|tabview)\.js$",
            "^%{SITE_NC_ROOT}apps/circles/css/(navigation|notyf)\.css$",
            "^%{SITE_NC_ROOT}apps/circles/css/files/circles\.filelist\.css$",
            "^%{SITE_NC_ROOT}apps/circles/img/(add-user|black_circle|circles|colored|join|link-group)\.svg$",
            "^%{SITE_NC_ROOT}apps/circles/js/circles\.app\.(actions|elements|navigation|settings)\.js$",
            "^%{SITE_NC_ROOT}apps/circles/js/circles\.app\.js$",
            "^%{SITE_NC_ROOT}apps/circles/js/circles\.app\.results\.(circles|groups|links|members)\.js$",
            "^%{SITE_NC_ROOT}apps/circles/js/circles\.v1\.(circles\.|links\.|members\.)?js$",
            "^%{SITE_NC_ROOT}apps/circles/js/files/circles\.files\.(app|list)\.js$",
            "^%{SITE_NC_ROOT}apps/circles/js/vendor/notyf\.js$",
            "^%{SITE_NC_ROOT}apps/comments/(css|img)/comments\.(css|svg)$",
            "^%{SITE_NC_ROOT}apps/comments/js/(app|comment(collection|model|stabview|summarymodel)|filesplugin)\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/$",
            "^%{SITE_NC_ROOT}apps/contacts/css/(contacts|multi-select|share)\.css$",
            "^%{SITE_NC_ROOT}apps/contacts/css/jquery\.(Jcrop\.min|ocaddnew)\.css$",
            "^%{SITE_NC_ROOT}apps/contacts/css/public/style\.css$",
            "^%{SITE_NC_ROOT}apps/contacts/css/vendor/ui-select/select\.min\.css$",
            "^%{SITE_NC_ROOT}apps/contacts/img/contacts\.svg$",
            "^%{SITE_NC_ROOT}apps/contacts/img/favicon\.ico$",
            "^%{SITE_NC_ROOT}apps/contacts/js/(addressbooks|app|contacts|groups|jquery\.ocaddnew|modernizr\.custom|otherbackendconfig|share|storage)\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/contacts-inject-14\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/dav/dav\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/public/script\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-bootstrap/ui-bootstrap(-tpls)?\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-cache/angular-cache\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-cache/dist/angular-cache\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-click-outside/clickoutside\.directive\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-route/angular-route\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-route/angular-route\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-sanitize/angular-sanitize\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-sanitize/angular-sanitize\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-uuid4/angular-uuid4\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular-uuid4/angular-uuid4\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular/angular\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/angular/angular\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/jquery-timepicker/jquery\.timepicker\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/jquery-timepicker/jquery\.ui\.timepicker\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/ngclipboard/ngclipboard\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/ui-bootstrap/ui-bootstrap-tpls\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/ui-bootstrap/ui-bootstrap\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/ui-select/dist/select\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/ui-select/select\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/vcard/src/vcard\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/js/vendor/vcard/vcard\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/templates/(addressBook(List)?|avatar|contact(Details|Filter|Import|List)?|importScreen|group(List)?|newContactButton|propertyGroup|sortBy)\.html$",
            "^%{SITE_NC_ROOT}apps/contacts/templates/detailItems/(adr|date|email|groups|group(List)?|hidden|n|tel|text(area)?|url)\.html$",
            "^%{SITE_NC_ROOT}apps/contacts/vendor/blueimp-file-upload/js/jquery\.fileupload\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/vendor/blueimp-md5/js/md5\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/vendor/combobox\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/vendor/jcrop/js/jquery\.Jcrop\.min\.js$",
            "^%{SITE_NC_ROOT}apps/contacts/vendor/ui-multiselect/jquery\.multiselect\.css$",
            "^%{SITE_NC_ROOT}apps/contacts/vendor/ui-multiselect/src/jquery\.multiselect\.js$",
            "^%{SITE_NC_ROOT}apps/dashboard/components/fullcalendar/dist/fullcalendar\.min\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/dashboard/css/bootstrap-responsive\.min\.css$",
            "^%{SITE_NC_ROOT}apps/dashboard/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/dashboard/img/button-(down|up)(-dark)?\.svg$",
            "^%{SITE_NC_ROOT}apps/dashboard/img/button-up-down(-dark)?\.svg$",
            "^%{SITE_NC_ROOT}apps/dashboard/img/dashboard\.svg$",
            "^%{SITE_NC_ROOT}apps/dashboard/js/(activities|announcements|calendar|inbox)\.js$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/bordercloud/tether/dist/(cs|j)s/tether\.(min\.)?(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/datatables/datatables/media/(cs|j)s/jquery\.dataTables\.min\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/tinymce/tinymce/jquery\.tinymce\.min\.js$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/tinymce/tinymce/plugins/(colorpicker|fullscreen|image|link|media|textcolor)/plugin\.min\.js$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/tinymce/tinymce/skins/lightgray/(content|skin)\.min\.css$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/tinymce/tinymce/themes/modern/theme\.min\.js$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/tinymce/tinymce/tinymce\.min\.js$",
            "^%{SITE_NC_ROOT}apps/dashboard/vendor/twbs/bootstrap/dist/js/bootstrap\.min\.js$",
            "^%{SITE_NC_ROOT}apps/deck/(boards|stacks)/%{POSINT}$",
            "^%{SITE_NC_ROOT}apps/deck/img/(archive|color_picker|deck(-dark)?)\.svg$",
            "^%{SITE_NC_ROOT}apps/deck/img/favicon\.ico$",
            "^%{SITE_NC_ROOT}apps/deck/js/build/deck\.js$",
            "^%{SITE_NC_ROOT}apps/deck/js/build/vendor\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/dicomviewer/css/(bootstrap_accordion|captureImageDialog|sidebar|viewerviewerMainDialog)\.css$",
            "^%{SITE_NC_ROOT}apps/dicomviewer/css/external/font-awesome/font-awesome\.min\.css$",
            "^%{SITE_NC_ROOT}apps/dicomviewer/css/viewer(Main(Dialog)?)?\.css$",
            "^%{SITE_NC_ROOT}apps/dicomviewer/js/app\.bundle\.js$",
            "^%{SITE_NC_ROOT}apps/direct_menu/(cs|j)s/direct_menu\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/direct_menu/styles$",
            "^%{SITE_NC_ROOT}apps/documents/ajax/documents/list$",
            "^%{SITE_NC_ROOT}apps/documents/css/(share|style)\.css$",
            "^%{SITE_NC_ROOT}apps/documents/css//?3rdparty/webodf/(dojo-app|wodotexteditor|wodocollabpane)\.css$",
            "^%{SITE_NC_ROOT}apps/documents/css/fonts\.css$",
            "^%{SITE_NC_ROOT}apps/documents/img/documents\.svg$",
            "^%{SITE_NC_ROOT}apps/documents/index$",
            "^%{SITE_NC_ROOT}apps/documents/js/(admin|documents|personal|share)\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/resources/dijit/themes/claro/claro\.css$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/resources/dojo/resources/blank\.gif$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/resources/dojox/layout/resources/ExpandoPane\.css$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/resources/dojox/widget/ColorPicker/ColorPicker\.css$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/webodf/(dojo-amalgamation|webodf-debug)\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/webodf/editor/(Editor(Session)?|MemberListView|Tools)\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/webodf/editor/widgets/(aboutDialog|annotation|editHyperlinks|fontPicker|imageInserter|paragraphAlignment|paragraphStylesDialog|simpleStyles|undoRedoMenu)\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/webodf/editor/widgets/dialogWidgets/(editHyperlinkPane|idMangler)\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/3rdparty/webodf/editor/widgets/toolbarWidgets/currentStyle\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/viewer/viewer\.js$",
            "^%{SITE_NC_ROOT}apps/documents/js/widgets/(oc(Close|Logo|Share|Toolbar)|titleBar|zoomCombo)\.js$",
            "^%{SITE_NC_ROOT}apps/external/img/external\.svg$",
            "^%{SITE_NC_ROOT}apps/external/js/admin\.js$",
            "^%{SITE_NC_ROOT}apps/federatedfilesharing/css/3rdparty/gs-share/style\.css$",
            "^%{SITE_NC_ROOT}apps/federatedfilesharing/css/settings-personal\.css$",
            "^%{SITE_NC_ROOT}apps/federatedfilesharing/img/social-(diaspora|facebook|gnu|googleplus|twitter)\.svg$",
            "^%{SITE_NC_ROOT}apps/federatedfilesharing/js/(external|settings-(admin|personal))\.js$",
            "^%{SITE_NC_ROOT}apps/federatedfilesharing/js/3rdparty/gs-share/gs-share\.js$",
            "^%{SITE_NC_ROOT}apps/federation/(cs|j)s/settings-admin\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/files/?$",
            "^%{SITE_NC_ROOT}apps/files/api/v1/sorting$",
            "^%{SITE_NC_ROOT}apps/files/api/v1/tags/_%24!%3CFavorite%3E!%24_/files$",
            "^%{SITE_NC_ROOT}apps/files/css/(detailsView|files|mobile|upload)\.css$",
            "^%{SITE_NC_ROOT}apps/files/img/((add|delete)-color|change|delete|external|folder|public|share|star)\.svg$",
            "^%{SITE_NC_ROOT}apps/files/js/(admin|app|breadcrumb|detailfileinfoview|detailsview|detailtabview|favoritesfilelist|files|filesummary|file-upload|favoritesplugin|fileactions|fileactionsmenu|fileinfomodel|filelist|gotoplugin|keyboardshortcuts|mainfileinfodetailview|navigation|newfilemenu|search|sidebarpreview(manager|text)|tagsplugin|upload)\.js$",
            "^%{SITE_NC_ROOT}apps/files/js/jquery(\.fileupload|\.iframe-transport|-visibility)\.js$",
            "^%{SITE_NC_ROOT}apps/files_(external|pdfviewer|sharing|texteditor|trashbin|versions|videoplayer)/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/files_accesscontrol/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/files_accesscontrol/js/admin\.js$",
            "^%{SITE_NC_ROOT}apps/files_antivirus/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/files_automatedtagging/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/files_clipboard/css/clipboard\.css$",
            "^%{SITE_NC_ROOT}apps/files_clipboard/img/(copy|cut|paste)\.svg$",
            "^%{SITE_NC_ROOT}apps/files_clipboard/js/c(learC)?lipboard\.js$",
            "^%{SITE_NC_ROOT}apps/files_external/css/(external|settings)\.css$",
            "^%{SITE_NC_ROOT}apps/files_external/globalstorages(/%{POSINT})?$",
            "^%{SITE_NC_ROOT}apps/files_external/js/(app|dropbox|gdrive|mountsfilelist|rollingqueue|statusmanager|oauth(1|2)|public_key|settings)\.js$",
            "^%{SITE_NC_ROOT}apps/files_external/user(global)?storages$",
            "^%{SITE_NC_ROOT}apps/files_mv/css/mv\.css$",
            "^%{SITE_NC_ROOT}apps/files_mv/js/move\.js$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/css/(style|viewer)\.css$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/css/minmode\.css",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/img/toolbarButton-secondaryToolbarClose\.svg$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/js/(previewplugin|workersrc)\.js$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/build/pdf(\.worker)?\.js$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/(compatibility|l10n)\.js$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/(loading-(icon|small)|toolbarButton-(bookmark|download|openFile|presentationMode|print|search)|shadow|texture)\.(gif|png)$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/loading-small@2x.png$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/secondaryToolbarButton-(documentProperties|handTool|rotateCc?w|(last|first)Page)\.png",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/toolbarButton-(bookmark|download|menuArrows|openFile|presentationMode|print|search|sidebarToggle)@2x.png$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/toolbarButton-(menuArrows|page(|Down|Up)|secondaryToolbarToggle|sidebarToggle|view(Attachments|Outline|Thumbnail)|zoom(In|Out))\.png$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/toolbarButton-page(Down|Up)@2x.png$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/toolbarButton-view(Attachments|Outline|Thumbnail)@2x.png$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/toolbarButton-zoom(In|Out)@2x.png$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/locale/en-US/viewer\.properties$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/locale/locale.properties$",
            "^%{SITE_NC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/viewer\.(j|cs)s$",
            "^%{SITE_NC_ROOT}apps/files_reader/$",
            "^%{SITE_NC_ROOT}apps/files_reader/css/(main|normalize|popup|tooltip).css$",
            "^%{SITE_NC_ROOT}apps/files_reader/css/font/fontello.woff$",
            "^%{SITE_NC_ROOT}apps/files_reader/img/loading.gif$",
            "^%{SITE_NC_ROOT}apps/files_reader/js/(plugin|ready)\.js$",
            "^%{SITE_NC_ROOT}apps/files_reader/js/lib/(Blob|typedarray.min|wgxpath.install).js$",
            "^%{SITE_NC_ROOT}apps/files_reader/vendor/epubjs/(hooks|epub|reader).min.js$",
            "^%{SITE_NC_ROOT}apps/files_reader/vendor/epubjs/hooks/extensions/highlight.js$",
            "^%{SITE_NC_ROOT}apps/files_reader/vendor/epubjs/libs/(zip|screenfull|jquery).min.js$",
            "^%{SITE_NC_ROOT}apps/files_rightclick/js/files\.js$",
            "^%{SITE_NC_ROOT}apps/files_sharing/css/(settings-personal|share(breadcrumb|tabview))\.css$",
            "^%{SITE_NC_ROOT}apps/files_sharing/css/3rdparty/gs-share/style\.css$",
            "^%{SITE_NC_ROOT}apps/files_sharing/img/social-(diaspora|facebook|gnu|googleplus|twitter)\.svg$",
            "^%{SITE_NC_ROOT}apps/files_sharing/js/(app|external|settings-(admin|personal)|share|sharedfilelist|sharetabview)\.js$",
            "^%{SITE_NC_ROOT}apps/files_sharing/js/3rdparty/gs-share/gs-share\.js$",
            "^%{SITE_NC_ROOT}apps/files_texteditor/ajax/(load|save)file$",
            "^%{SITE_NC_ROOT}apps/files_texteditor/css/(mobile|style)\.css$",
            "^%{SITE_NC_ROOT}apps/files_texteditor/css/DroidSansMono/stylesheet\.css$",
            "^%{SITE_NC_ROOT}apps/files_texteditor/js/editor\.js$",
            "^%{SITE_NC_ROOT}apps/files_texteditor/js/vendor/ace/src-noconflict/(ace|mode-(html|python)|theme-clouds)\.js$",
            "^%{SITE_NC_ROOT}apps/files_trashbin/css/trash\.css$",
            "^%{SITE_NC_ROOT}apps/files_trashbin/js/(app|filelist)\.js$",
            "^%{SITE_NC_ROOT}apps/files_versions/ajax/getVersions.php$",
            "^%{SITE_NC_ROOT}apps/files_versions/css/versions\.css$",
            "^%{SITE_NC_ROOT}apps/files_versions/js/(filesplugin|versioncollection|versionmodel|versionstabview)\.js$",
            "^%{SITE_NC_ROOT}apps/files_video(play|view)er/css/(style|mediaelementplayer)\.css$",
            "^%{SITE_NC_ROOT}apps/files_video(play|view)er/js/viewer\.js$",
            "^%{SITE_NC_ROOT}apps/firstrunwizard/css/(colorbox|firstrunwizard)\.css$",
            "^%{SITE_NC_ROOT}apps/firstrunwizard/img/(app|info)\.svg$",
            "^%{SITE_NC_ROOT}apps/firstrunwizard/js/(firstrunwizard|jquery\.colorbox)\.js$",
            "^%{SITE_NC_ROOT}apps/fulltextsearch/img/fulltextsearch\.svg$",
            "^%{SITE_NC_ROOT}apps/gallery/$",
            "^%{SITE_NC_ROOT}apps/gallery/(slideshow|thumbnails)$",
            "^%{SITE_NC_ROOT}apps/gallery/config$",
            "^%{SITE_NC_ROOT}apps/gallery/css/(gallerybutton|github-markdown|mobile|share|slideshow|styles|upload)\.css$",
            "^%{SITE_NC_ROOT}apps/gallery/files/list$",
            "^%{SITE_NC_ROOT}apps/gallery/img/(app|date(asc|des)|gallery-dark|name(asc|des)|toggle|view-delete)\.svg$",
            "^%{SITE_NC_ROOT}apps/gallery/js/(app|breadcrumb|eventsource|gallery(album|button|config|fileaction|image|infobox|row|utility|view)?|newfilemenuplugins||thumbnail|upload-helper)\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/slideshow(controls|zoomablepreview)?\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/bigshot/bigshot-compressed\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/commonmark/dist/commonmark\.min\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/dompurify/src/purify\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/jquery-touch-events/src/[0-9.]+/jquery\.mobile-events\.min\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/jquery\.ui\.touch-punch-custom\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/modified-eventsource-polyfill/eventsource-polyfill\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/js/vendor/nextcloud/(newfilemenu|share)\.js$",
            "^%{SITE_NC_ROOT}apps/gallery/preview/%{POSINT}$",
            "^%{SITE_NC_ROOT}apps/groupfolders/js/files\.js$",
            "^%{SITE_NC_ROOT}apps/html5_videoplayer/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/html5_videoplayer/js/viewer\.js$",
            "^%{SITE_NC_ROOT}apps/music/css/(mobile|settings-user|style|style-controls|style-sidebar|tablet)\.css$",
            "^%{SITE_NC_ROOT}apps/music/img/(music|pause-big|play-big|play-next|play-previous|repeat|shuffle)\.svg$",
            "^%{SITE_NC_ROOT}apps/music/js/app/playerwrapper\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/public/(app|fileactions|musicFilePlayer|settings-user)\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/angular-gettext/dist/angular-gettext\.min\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/angular-route/angular-route\.min\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/angular/angular\.min\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/aurora/(aurora|flac|mp3)\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/restangular/dist/restangular\.min\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/soundmanager/script/soundmanager2-nodebug-jsmin\.js$",
            "^%{SITE_NC_ROOT}apps/music/js/vendor/underscore/underscore-min\.js$",
            "^%{SITE_NC_ROOT}apps/notifications/css/styles\.css$",
            "^%{SITE_NC_ROOT}apps/notifications/img/notifications(-new)?\.svg$",
            "^%{SITE_NC_ROOT}apps/notifications/js/(app|notifications?|richObjectStringParser)\.js$",
            "^%{SITE_NC_ROOT}apps/ojsxc/css/jsxc\.oc\.css$",
            "^%{SITE_NC_ROOT}apps/ojsxc/img/chat-icon-white\.svg$",
            "^%{SITE_NC_ROOT}apps/ojsxc/img/actions/chat\.svg$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/jsxc/img/(contact|gear|help|menu|more)_black\.svg$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/jsxc/img/presence_(away|chat|dnd|xa)\.svg$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/jsxc/jsxc\.min\.js$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/jsxc/lib/jquery\.(fullscreen|slimscroll)\.js$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/jsxc/lib/jsxc\.dep\.min\.js$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/jsxc/lib/jsxc\.otr\.webworker\.js$",
            "^%{SITE_NC_ROOT}apps/ojsxc/js/ojsxc\.js$",
            "^%{SITE_NC_ROOT}apps/ownnote/$",
            "^%{SITE_NC_ROOT}apps/ownnote/ajax/v0\.2/ownnote/ajax(announcement|create|del|edit|index|save)$",
            "^%{SITE_NC_ROOT}apps/ownnote/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/ownnote/img/(delete(-hover)?|triangle-n)\.png$",
            "^%{SITE_NC_ROOT}apps/ownnote/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/ownnote/img/triangle-n\.svg$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/(admin|script)\.js$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/plugins/(advlist|anchor|autolink|autoresize|bdesk_photo|charmap|code|context_menu|fullscreen|insertdatetime|link|lists|media|preview|print|searchreplace|table|visualblocks)/plugin\.min\.js$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/plugins/contextmenu/plugin\.min\.js$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/skins/lightgray/content\.min\.css$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/skins/lightgray/fonts/tinymce\.woff$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/skins/lightgray/skin\.min\.css$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/themes/modern/theme\.min\.js$",
            "^%{SITE_NC_ROOT}apps/ownnote/js/tinymce/tinymce\.min\.js$",
            "^%{SITE_NC_ROOT}apps/ownnote/l10n/en\.js$",
            "^%{SITE_NC_ROOT}apps/password_policy/(cs|j)s/settings-admin\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/radio/css/main\.css$",
            "^%{SITE_NC_ROOT}apps/radio/img/(folder|radio|recent|star|systemtags)\.svg$",
            "^%{SITE_NC_ROOT}apps/radio/img/(play|pause|radio|sound_(full|mid|silent)|wheel)\.png$",
            "^%{SITE_NC_ROOT}apps/radio/js/(main|navigation|player)\.js$",
            "^%{SITE_NC_ROOT}apps/search_lucene/css/lucene\.css$",
            "^%{SITE_NC_ROOT}apps/search_lucene/js/checker\.js$",
            "^%{SITE_NC_ROOT}apps/serverinfo/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/serverinfo/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/serverinfo/js/(Chart\.min|script|smoothie)\.js$",
            "^%{SITE_NC_ROOT}apps/serverinfo/update$",
            "^%{SITE_NC_ROOT}apps/shorten/js/(admin|script)\.js$",
            "^%{SITE_NC_ROOT}apps/socialsharing_(diaspora|email|facebook|googleplus|twitter)/(cs|j)s/socialsharing(diaspora|email|facebook|googleplus|twitter)\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/spreed/img/favicon\.ico$",
            "^%{SITE_NC_ROOT}apps/spreed/img/(app-dark|no-password)\.svg$",
            "^%{SITE_NC_ROOT}apps/spreed/js/(app|connection|init)\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/(richobjectstringparser|signaling|simplewebrtc)\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/models/(chatmessage|participant|room)(collection)?\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/vendor/At\.js/dist/js/jquery\.atwho\.min\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/vendor/Caret\.js/dist/jquery\.caret\.min\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/vendor/backbone/backbone-min\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/vendor/backbone\.marionette/lib/backbone\.marionette\.min\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/vendor/backbone\.radio/build/backbone\.radio\.min\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/vendor/jshashes/hashes\.min\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/views/(callinfo|chat|participant(list)?|roomlist|sidebar|tab)view\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/views/editabletextlabel\.js$",
            "^%{SITE_NC_ROOT}apps/spreed/js/webrtc\.js$",
            "^%{SITE_NC_ROOT}apps/survey_client/(cs|j)s/admin\.(cs|j)s$",
            "^%{SITE_NC_ROOT}apps/systemtags/css/systemtagsfilelist\.css$",
            "^%{SITE_NC_ROOT}apps/systemtags/img/(app|tag)\.svg$",
            "^%{SITE_NC_ROOT}apps/systemtags/js/(admin|app|filesplugin|systemtagsfilelist|systemtagsinfoview)\.js$",
            "^%{SITE_NC_ROOT}apps/systemtags/lastused$",
            "^%{SITE_NC_ROOT}apps/tasks/img/favicon\.ico$",
            "^%{SITE_NC_ROOT}apps/tasks/img/sprites\.svg$",
            "^%{SITE_NC_ROOT}apps/tasks/img/tasks\.svg$",
            "^%{SITE_NC_ROOT}apps/tasks/templates/colorpicker\.html$",
            "^%{SITE_NC_ROOT}apps/templateeditor/css/settings-admin\.css$",
            "^%{SITE_NC_ROOT}apps/templateeditor/js/settings-admin\.js$",
            "^%{SITE_NC_ROOT}apps/theming/css/settings-admin\.css$",
            "^%{SITE_NC_ROOT}apps/theming/img/core/filetypes/(application|file|folder(-(external|public))?|image|package-x-generic|text|video|x-office-(presentation|document))\.svg",
            "^%{SITE_NC_ROOT}apps/theming/js/(settings-admin|theming)\.js$",
            "^%{SITE_NC_ROOT}apps/theming/js/3rdparty/jscolor/jscolor\.js$",
            "^%{SITE_NC_ROOT}apps/theming/js/theming$",
            "^%{SITE_NC_ROOT}apps/theming/styles$",
            "^%{SITE_NC_ROOT}apps/twofactor_u2f/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/twofactor_u2f/js/build/challenge\.js$",
            "^%{SITE_NC_ROOT}apps/updatenotification/img/app\.svg$",
            "^%{SITE_NC_ROOT}apps/updatenotification/js/admin\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/ajax/(get|test)Configuration\.php$",
            "^%{SITE_NC_ROOT}apps/user_ldap/ajax/wizard\.php$",
            "^%{SITE_NC_ROOT}apps/user_ldap/css/settings\.css$",
            "^%{SITE_NC_ROOT}apps/user_ldap/img/copy\.svg$",
            "^%{SITE_NC_ROOT}apps/user_ldap/js/wizard/(configModel|controller|view|wizard)\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/js/wizard/wizardDetector(AvailableAttributes|BaseDN|ClearGroupMappings|ClearUserMappings|EmailAttribute|FeatureAbstract|FilterGroup|FilterLogin|FilterUser|Generic|GroupCount|GroupObjectClasses|GroupsForUsers|Port|Queue|SimpleRequestAbstract|TestAbstract|TestBaseDN|TestConfiguration|TestLoginName|UserCount|UserDisplayNameAttribute|UserGroupAssociation|UserObjectClasses)\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/js/wizard/wizardDetectorGroupsForGroups\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/js/wizard/wizardFilterOnType(Factory)?\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/js/wizard/wizardObject\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/js/wizard/wizardTab(AbstractFilter|Advanced|Elementary|Expert|Generic|GroupFilter|LoginFilter|UserFilter)\.js$",
            "^%{SITE_NC_ROOT}apps/user_ldap/vendor/ui-multiselect/jquery\.multiselect\.css$",
            "^%{SITE_NC_ROOT}apps/user_ldap/vendor/ui-multiselect/src/jquery\.multiselect\.js$",
            "^%{SITE_NC_ROOT}apps/weather/$",
            "^%{SITE_NC_ROOT}apps/weather/city/(add|getall)$",
            "^%{SITE_NC_ROOT}apps/weather/css/style\.css$",
            "^%{SITE_NC_ROOT}apps/weather/img/$",
            "^%{SITE_NC_ROOT}apps/weather/img/(app-icon|home-(no)?pick|sun)\.png$",
            "^%{SITE_NC_ROOT}apps/weather/js/angular/angular\.min\.js$",
            "^%{SITE_NC_ROOT}apps/weather/js/public/app\.js$",
            "^%{SITE_NC_ROOT}apps/weather/settings/(apikey|metric)/[gs]et$",
            "^%{SITE_NC_ROOT}apps/weather/weather/get$",
            "^%{SITE_NC_ROOT}apps/workflowengine/css/admin\.css$",
            "^%{SITE_NC_ROOT}apps/workflowengine/js/(admin|usergroupmembershipplugin)\.js$",
            "^%{SITE_NC_ROOT}apps/workflowengine/js/file(mimetype|size|systemtags)plugin\.js$",
            "^%{SITE_NC_ROOT}apps/workflowengine/js/request(remoteaddress|time|url|useragent)plugin\.js$",
            "^%{SITE_NC_ROOT}apps/workflowengine/operations$"
          ] }
        }
      } else if [http][request][path] =~ /^\/core/ {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_NC_ROOT}core/ajax/update\.php$",
            "^%{SITE_NC_ROOT}core/css/(apps|fixes|fonts|global|guest|header|icons|jquery\.ocdialog|jquery-ui-fixes|mobile|multiselect|share|styles|tooltip)\.css$",
            "^%{SITE_NC_ROOT}core/css/images/ui-(icons|bg_flat|bg_glass|bg_flat|bg_highlight-soft)(_\d+)?_%{BASE16NUM}_%{POSINT}x%{POSINT}\.png$",
            "^%{SITE_NC_ROOT}core/css/images/ui-bg_(flat|glass|highlight-(hard|soft))_%{INT}_%{BASE16NUM}_%{POSINT}x%{POSINT}\.png$",
            "^%{SITE_NC_ROOT}core/css/images/ui-icons_%{BASE16NUM}_%{POSINT}x%{POSINT}\.png$",
            "^%{SITE_NC_ROOT}core/css/inputs\.css$",
            "^%{SITE_NC_ROOT}core/css/systemtags\.css$",
            "^%{SITE_NC_ROOT}core/doc/user/_static/(bootstrap-sphinx|doctools|jquery(-1\.11\.0.min|-fix)?|main\.min|pygments|styles|underscore)\.css$",
            "^%{SITE_NC_ROOT}core/doc/user/_static/bootstrap-3\.1\.0/js/bootstrap\.min\.js$",
            "^%{SITE_NC_ROOT}core/doc/user/_static/fonts/OpenSans-(Bold|Light)\.woff$",
            "^%{SITE_NC_ROOT}core/doc/user/index\.html$",
            "^%{SITE_NC_ROOT}core/fonts/OpenSans-(Light|Regular|Semibold)\.woff$",
            "^%{SITE_NC_ROOT}core/img/(appstore|background|breadcrumb|default-app-icon|desktopapp|favicon|googleplay|loading|loading-dark|loading-small|logo-icon)\.(gif|jpg|png|svg)$",
            "^%{SITE_NC_ROOT}core/img/actions/(add|caret|checkbox(-checked(close)?|-disabled)?|confirm(-white)?|delete(-white)?|(down|up)load(-white)?|history|info|logout|menu|more|play|search-white|settings|share|star|toggle-filelist|toggle-pictures|triangle-n|triangle-s|view-download)\.svg$",
            "^%{SITE_NC_ROOT}core/img/actions/(checkmark|checkmark-white|clippy|close|comment|details|delete-hover|external|info|mail|password|public|rename|starred|star-dark|tag|user|view-close|view-next|view-pause|view-play|view-previous)\.svg$",
            "^%{SITE_NC_ROOT}core/img/actions/(checkbox-mark|default-app-icon|info|radio(-checked)?|search)\.(png|svg)$",
            "^%{SITE_NC_ROOT}core/img/favicon(-touch)?\.(ico|png)$",
            "^%{SITE_NC_ROOT}core/img/filetypes/(application|application-pdf|file|folder|folder-(external|drag-accept)|image|logo|package-x-generic|text|text-code|x-office-document|package-x-generic|video|x-office-presentation|x-office-spreadsheet)\.(png|svg)$",
            "^%{SITE_NC_ROOT}core/img/logo\.(png|svg)$",
            "^%{SITE_NC_ROOT}core/img/places/(calendar|contacts(-dark)?|files|home)\.svg$",
            "^%{SITE_NC_ROOT}core/img/rating/s%{POSINT}\.(png|svg)$",
            "^%{SITE_NC_ROOT}core/js/(apps|avatar|compatibility|config|eventsource|integritycheck-failed-notification|jquery\.avatar|jquery\.ocdialog|js|l10n|login|lostpassword|maintenance-check|mimetype|mimetypelist|multiselect|sharedialoggmailview|tags)\.js$",
            "^%{SITE_NC_ROOT}core/js/(oc|oc-backbone(-webdav)?|oc-(dialogs|requesttoken)|octemplate|select2-toggleselect|setupchecks)\.js$",
            "^%{SITE_NC_ROOT}core/js/(placeholders?|share|share(configmodel|contactsmenu||dialog(expiration|linkshare|mail|resharerinfo|shareelist)?view)|shareitemmodel|update|visitortimezone)\.js$",
            "^%{SITE_NC_ROOT}core/js/contactsmenu\.js$",
            "^%{SITE_NC_ROOT}core/js/files/(client|fileinfo)\.js$",
            "^%{SITE_NC_ROOT}core/js/jquery-ui-fixes\.js$",
            "^%{SITE_NC_ROOT}core/js/public/appconfig\.js$",
            "^%{SITE_NC_ROOT}core/js/systemtags/systemtag(model|s|scollection|sinputfield|smappingcollection)\.js$",
            "^%{SITE_NC_ROOT}core/preview\.png$",
            "^%{SITE_NC_ROOT}core/search/js/search(provider)?\.js$",
            "^%{SITE_NC_ROOT}core/search/templates/part\.results\.html$",
            "^%{SITE_NC_ROOT}core/templates/(filepicker|message)\.html$",
            "^%{SITE_NC_ROOT}core/vendor/[-\w_/]+/([-\w./]+/)?[-\w.]+\.(css|js)$",
            "^%{SITE_NC_ROOT}core/vendor/backbone/backbone\.js$",
            "^%{SITE_NC_ROOT}core/vendor/blueimp-md5/js/md5\.js$",
            "^%{SITE_NC_ROOT}core/vendor/bootstrap/js/tooltip\.js$",
            "^%{SITE_NC_ROOT}core/vendor/core\.js$",
            "^%{SITE_NC_ROOT}core/vendor/davclient\.js/lib/client\.js$",
            "^%{SITE_NC_ROOT}core/vendor/handlebars/handlebars\.js$",
            "^%{SITE_NC_ROOT}core/vendor/jquery-migrate/jquery-migrate\.min\.js$",
            "^%{SITE_NC_ROOT}core/vendor/jquery-ui/themes/base/images/ui-icons_%{POSINT}_%{POSINT}x%{POSINT}\.png$",
            "^%{SITE_NC_ROOT}core/vendor/jquery-ui/themes/base/jquery-ui\.css$",
            "^%{SITE_NC_ROOT}core/vendor/jquery-ui/ui/jquery-ui\.custom\.js$",
            "^%{SITE_NC_ROOT}core/vendor/jquery/dist/jquery\.min\.map$",
            "^%{SITE_NC_ROOT}core/vendor/jquery/jquery\.min\.js$",
            "^%{SITE_NC_ROOT}core/vendor/jsTimezoneDetect/jstz\.js$",
            "^%{SITE_NC_ROOT}core/vendor/moment/min/moment-with-locales\.js$",
            "^%{SITE_NC_ROOT}core/vendor/select2/select2-spinner\.gif$",
            "^%{SITE_NC_ROOT}core/vendor/select2/select2\.png$",
            "^%{SITE_NC_ROOT}core/vendor/snapjs/dist/latest/snap\.js$",
            "^%{SITE_NC_ROOT}core/vendor/underscore/underscore\.js$",
            "^%{SITE_NC_ROOT}core/vendor/zxcvbn/zxcvbn\.js$"
          ] }
        }
      } else if [http][request][path] =~ /^\/index\.php/ {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_NC_ROOT}index\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/activity/$",
            "^%{SITE_NC_ROOT}index\.php/apps/activity/activities/fetch$",
            "^%{SITE_NC_ROOT}index\.php/apps/activity/api/v2/activity/(all|filter)$",
            "^%{SITE_NC_ROOT}index\.php/apps/announcementcenter/(announcement)?$",
            "^%{SITE_NC_ROOT}index\.php/apps/audioplayer/(checknewtracks|get(audio(info|stream)|category(items)?|cover|import?tpl|progress|value)|resetmedialibrary|scanforaudiofiles|set(statistics|value))?(/%{POSINT})?$",
            "^%{SITE_NC_ROOT}index\.php/apps/bookmarks/(bookmark|click|tag)?$",
            "^%{SITE_NC_ROOT}index\.php/apps/bookmarks/bookmark/%{POSINT}/(favicon|image)$",
            "^%{SITE_NC_ROOT}index\.php/apps/bookmarks/settings/sort$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/(ajax/cache/status\.php)?$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/ajax/calendar/(activation|changeview|edit|update)(\.form)\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/ajax/event/(delete|edit|new)\.(form\.)?php$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/ajax/events\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/ajax/settings/(get(firstday|timezonedetection)|timeformat)\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/export\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/js/(idtype|l10n)\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/v1/config$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/v1/timezones/%{NOTSPACE}\.ics$",
            "^%{SITE_NC_ROOT}index\.php/apps/calendar/v1/view$",
            "^%{SITE_NC_ROOT}index\.php/apps/circles/$",
            "^%{SITE_NC_ROOT}index\.php/apps/circles/settings$",
            "^%{SITE_NC_ROOT}index\.php/apps/circles/v1/circles(/%{BASE16NUM})?$",
            "^%{SITE_NC_ROOT}index\.php/apps/circles/v1/globalsearch$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/addressbook/local/%{POSINT}/contact/(%{POSINT}|add)$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/addressbook/local/%{POSINT}/contacts?(/%{POSINT}/photo)?$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/addressbooks/$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/ajax/config\.js$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/connectors/%7Bbackend%7D$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/groups/$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/groups/addto/%{POSINT}$",
            "^%{SITE_NC_ROOT}index\.php/apps/contacts/preference/set$",
            "^%{SITE_NC_ROOT}index\.php/apps/dashboard/$",
            "^%{SITE_NC_ROOT}index\.php/apps/dashboard/(activities|announcements|event_sources|inbox)$",
            "^%{SITE_NC_ROOT}index\.php/apps/dashboard/events/(%{POSINT}|shared_events)$",
            "^%{SITE_NC_ROOT}index\.php/apps/deck/$",
            "^%{SITE_NC_ROOT}index\.php/apps/deck/boards$",
            "^%{SITE_NC_ROOT}index\.php/apps/deck/(boards|stacks)/%{POSINT}$",
            "^%{SITE_NC_ROOT}index\.php/apps/documents/ajax/documents/list$",
            "^%{SITE_NC_ROOT}index\.php/apps/documents/ajax/mimes\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/documents/index$",
            "^%{SITE_NC_ROOT}index\.php/apps/files/?$",
            "^%{SITE_NC_ROOT}index\.php/apps/files/ajax/(download|getstoragestats|list|scan|upload)\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/files/api/v1/recent$",
            "^%{SITE_NC_ROOT}index\.php/apps/files/api/v1/thumbnail/%{POSINT}/%{POSINT}/%{DATA:[files][src][filename]}$",
            "^%{SITE_NC_ROOT}index\.php/apps/files/undefined/img/notifications(-new)?\.svg$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_clipboard/ajax/clipboard\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_external/globalstorages(/%{POSINT})?$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_external/user(global)?storages(/%{POSINT})?$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_pdfviewer/$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_sharing/api/externalShares$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_texteditor/ajax/(load|save)file$",
            "^%{SITE_NC_ROOT}index\.php/apps/files_versions/ajax/getVersions\.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/gallery/$",
            "^%{SITE_NC_ROOT}index\.php/apps/gallery/preview/%{POSINT}$",
            "^%{SITE_NC_ROOT}index\.php/apps/gallery/(config|slideshow|thumbnails)$",
            "^%{SITE_NC_ROOT}index\.php/apps/gallery/files/(download|preview)/%{POSINT}$",
            "^%{SITE_NC_ROOT}index\.php/apps/gallery/files/list$",
            "^%{SITE_NC_ROOT}index\.php/apps/music/$",
            "^%{SITE_NC_ROOT}index\.php/apps/music/api/(collection|scan)$",
            "^%{SITE_NC_ROOT}index\.php/apps/music/api/album/%{POSINT}/cover$",
            "^%{SITE_NC_ROOT}index\.php/apps/ojsxc/http-bind$",
            "^%{SITE_NC_ROOT}index\.php/apps/ojsxc/js/config$",
            "^%{SITE_NC_ROOT}index\.php/apps/ojsxc/settings/(iceServers|servertype)$",
            "^%{SITE_NC_ROOT}index\.php/apps/ownnote/$",
            "^%{SITE_NC_ROOT}index\.php/apps/ownnote/ajax/v[0-9.]+/ownnote/ajax(announcement|edit|index|save)$",
            "^%{SITE_NC_ROOT}index\.php/apps/ownnote/api/v[0-9.]+/ownnote/(mobileindex|version|save|edit)$",
            "^%{SITE_NC_ROOT}index\.php/apps/radio$",
            "^%{SITE_NC_ROOT}index\.php/apps/radio/(get(Menu|Volume)|saveMenu)State$",
            "^%{SITE_NC_ROOT}index\.php/apps/radio/stations$",
            "^%{SITE_NC_ROOT}index\.php/apps/serverinfo/update$",
            "^%{SITE_NC_ROOT}index\.php/apps/spreed/$",
            "^%{SITE_NC_ROOT}index\.php/apps/systemtags/lastused$",
            "^%{SITE_NC_ROOT}index\.php/apps/tasks/$",
            "^%{SITE_NC_ROOT}index\.php/apps/tasks/(collections|settings)$",
            "^%{SITE_NC_ROOT}index\.php/apps/tasks/templates/confirmation$",
            "^%{SITE_NC_ROOT}index\.php/apps/theming/img/core/filetypes/(application(-pdf)?|file|folder(-external|-public)?|image|package-x-generic|text-code|x-office-document)\.svg$",
            "^%{SITE_NC_ROOT}index\.php/apps/theming/js/theming$",
            "^%{SITE_NC_ROOT}index\.php/apps/theming/styles$",
            "^%{SITE_NC_ROOT}index\.php/apps/user_ldap/ajax/(get|test)Configuration.php$",
            "^%{SITE_NC_ROOT}index\.php/apps/user_ldap/ajax/wizard\.php$",
            "^%{SITE_NC_ROOT}index\.php/avatar/%{USER_DST}/%{POSINT}$",
            "^%{SITE_NC_ROOT}index\.php/contactsmenu/contacts$",
            "^%{SITE_NC_ROOT}index\.php/core/ajax/(appconfig|share)\.php$",
            "^%{SITE_NC_ROOT}index\.php/core/js/oc\.js$",
            "^%{SITE_NC_ROOT}index\.php/core/preview(\.png)?$",
            "^%{SITE_NC_ROOT}index\.php/(csrftoken|displaynames|heartbeat)$",
            "^%{SITE_NC_ROOT}index\.php/js/activity/activity-sidebar\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/comments/merged\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/core/merged(-template-prepend)?\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/core/merged-share-backend\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/files/merged-index\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/files_sharing/additionalScripts\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/files_texteditor/merged\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/files_versions/merged\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/gallery/merged\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/gallery/scripts-for-file-app\.js$",
            "^%{SITE_NC_ROOT}index\.php/js/systemtags/merged\.js$",
            "^%{SITE_NC_ROOT}index\.php/log(in|out)$",
            "^%{SITE_NC_ROOT}index\.php/login/(confirm|selectchallenge)$",
            "^%{SITE_NC_ROOT}index\.php/login/challenge/u2f$",
            "^%{SITE_NC_ROOT}index\.php/ocs/cloud/user$",
            "^%{SITE_NC_ROOT}index\.php/s/%{BASE16NUM}(/download)?$",
            "^%{SITE_NC_ROOT}index\.php/settings/(admin|help|personal)$",
            "^%{SITE_NC_ROOT}index\.php/settings/admin/(additional|encryption|externalstorages|ldap|logging|serverinfo|sharing|survey_client|theming|tips-tricks|workflow)$",
            "^%{SITE_NC_ROOT}index\.php/settings/admin/log/(entries|level)$",
            "^%{SITE_NC_ROOT}index\.php/settings/ajax/(disableapp|enableapp|navigationdetect|uninstallapp|updateapp)\.php$",
            "^%{SITE_NC_ROOT}index\.php/settings/ajax/checksetup$",
            "^%{SITE_NC_ROOT}index\.php/settings/apps$",
            "^%{SITE_NC_ROOT}index\.php/settings/apps/(categories|(dis|en)able|list)$",
            "^%{SITE_NC_ROOT}index\.php/settings/apps/tools/defaultlinkopen$",
            "^%{SITE_NC_ROOT}index\.php/settings/apps/tools/undefined/img/notifications(-new)?\.svg$",
            "^%{SITE_NC_ROOT}index\.php/settings/apps/uninstall/%{NOTSPACE}$",
            "^%{SITE_NC_ROOT}index\.php/settings/users/groups$",
            "^%{SITE_NC_ROOT}index\.php/svg/core/actions/(address|audio|clippy|comment|confirm(-fade)?|external|fullscreen|history|info|rename|screen(-off)?|upload|video(-off)?)/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/svg/core/actions/(add|arrow-(left|right)|checkmark|close|delete|download|mail|menu|more|password|pause|play|public|quota|search|settings(-dark)?|share|star(-dark)?|tag|toggle-(background|pictures)|triangle-[ns]|user)/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/svg/core/categories/(bundles|customization|files|games|integration|monitoring|multimedia|office|organization|social)/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/svg/core/places/(contacts|home)/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/svg/files/(delete|external|folder|public|recent|share|unshare)/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/svg/spreed/menu-people/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/svg/systemtags/tag/%{BASE16NUM}$",
            "^%{SITE_NC_ROOT}index\.php/settings/integrity/failed$"
          ] }
        }
      } else {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_NC_ROOT}(/)?$",
            "^%{SITE_NC_ROOT}avatar/%{USER_DST}/%{INT}$",
            "^%{SITE_NC_ROOT}(displaynames|heartbeat|log(in|out))$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/activity/api/v2/activity/(all|by|calendar(_tools)?|circles|comments|files|files_(favorites|sharing)|filter|security|self)$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/activity/api/v2/activity/calendar_todo$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/files_external/api/v1/mounts$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/files_sharing/api/v[12]/(remote_)?sharee?s$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/notifications/api/v[12]/(notifications|push)$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/spreed/api/v1/(call|chat|signaling)/[a-z0-9]+$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/spreed/api/v1/room$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/spreed/api/v1/room/[a-z0-9]+/participants(/(active|self))?$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/apps/survey_client/api/v[12]/monthly$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/cloud/(activity|capabilities|group|user)$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/core/autocomplete/get$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/core/navigation/apps$",
            "^%{SITE_NC_ROOT}ocs/v[12]\.php/core/whatsnew$",
            "^%{SITE_NC_ROOT}remote\.php/$",
            "^%{SITE_NC_ROOT}remote\.php/ca(rd|l)dav/(addressbook|calendars|principals)/(%{USER_DST}/)?(contact_birthdays|defaultcalendar|personal)?/?$",
            "^%{SITE_NC_ROOT}remote\.php/ca(rd|l)dav/?$",
            "^%{SITE_NC_ROOT}remote\.php/caldav/calendars/%{USER_DST}/%{NOTSPACE}/[A-F0-9-]+.ics$",
            "^%{SITE_NC_ROOT}remote\.php/carddav/addressbooks/%{USER_DST}/((shard_)?contacts/([a-zA-Z0-9_./-]+)?([A-F0-9-]+.vcf)?)?$",
            "^%{SITE_NC_ROOT}remote\.php/carddav/addressbooks/%{USER_DST}/default/$",
            "^%{SITE_NC_ROOT}remote\.php/dav$",
            "^%{SITE_NC_ROOT}remote\.php/dav/addressbooks(/users/%{USER_DST}/((shard_)?contacts/([a-zA-Z0-9.-]+\.vcf)?)?)?$",
            "^%{SITE_NC_ROOT}remote\.php/dav/calendars/%{USER_DST}/(%{NOTSPACE}/?)?$",
            "^%{SITE_NC_ROOT}remote\.php/dav/comments/files/%{INT}/$",
            "^%{SITE_NC_ROOT}remote\.php/dav/files/%{USER_DST}/?(%{NOTSPACE})?$",
            "^%{SITE_NC_ROOT}remote\.php/dav/principals/users/%{USER_DST}/$",
            "^%{SITE_NC_ROOT}remote\.php/dav/systemtags(-relations/files)?/%{INT}$",
            "^%{SITE_NC_ROOT}remote\.php/webdav(%{PATH})?$",
            "^%{SITE_NC_ROOT}settings/admin(/(additional|encryption|externalstorages|files_accesscontrol|ldap|log/entries|logging|serverinfo|sharing|survey_client|theming|tips-tricks|workflow))?$",
            "^%{SITE_NC_ROOT}settings/ajax/checksetup$",
            "^%{SITE_NC_ROOT}settings/apps(/(categories|list))?$",
            "^%{SITE_NC_ROOT}settings/css/settings\.css$",
            "^%{SITE_NC_ROOT}settings/img/(admin|apps|help|personal|users)\.svg$",
            "^%{SITE_NC_ROOT}settings/integrity/failed$",
            "^%{SITE_NC_ROOT}settings/js/(admin|apps|authtoken(_collection|_view)?|certificates|log|personal|settings(-vue)?)\.js$",
            "^%{SITE_NC_ROOT}settings/personal(/authtokens)?$",
            "^%{SITE_NC_ROOT}settings/users/groups$",
            "^%{SITE_NC_ROOT}status\.php$"
          ] }
        }
      }
    }
    if [files][dst][filename] {
      urldecode {
        field => "[files][dst][filename]"
      }
    }
  }
  if [type] == "nextcloud" {
    if [http][request][path] =~ /\/notifications$/ and [message] == "Current user is not logged in" {
      mutate {
        add_tag => [ "Known Message", "Benign" ]
      }
    } 
    grok {
      tag_on_failure => [ ]
      add_tag => [ "Known Message" ]
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      match => { "message" => [
        "^%{PATH} is locked$",
        "^Count filter:  objectclass=\*$",
        "^File: %{PATH} modified since opening\.$",
        "^HTTP\/[12]\.[10] 401 No 'Authorization: Basic' header found. Either the client didn't send one, or the server is mis-configured$",
        "^HTTP\/[12]\.[10] 401 No basic authentication headers were found$",
        "^HTTP\/[12]\.[10] 423 \"[0-9a-zA-Z_. -]+\" is locked$",
        "^HTTP\/[12]\.[10] 503 System in maintenance mode.$",
        "^No update found at the ownCloud appstore for app %{POSINT}$",
        "^starting upgrade from [0-9.]+ to [0-9/]+$"
      ] }
    }
    grok {
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Error" ]
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      match => { "message" => [
        "^!!! Path '%{DATA:[files][dst][filename]}' is not accessible or present !!!$",
        "^(copy|fopen)\(%{DATA:[files][dst][filename]}\): failed to open stream: (No such file or directory|Permission denied) at %{FILENAME}#%{INT}$",
        "^(fclose|fread)\(%{DATA:[files][dst][filename]}\) expects parameter 1 to be resource, boolean given at %{FILENAME}#%{INT}$",
        "^(filesize|stat)\(%{DATA:[files][dst][filename]}\): stat failed for %{FILENAME_SRC} at %{FILENAME}#%{INT}$",
        "^(mkdir|rmdir|unlink)\(%{DATA:[files][dst][filename]}\): Permission denied at %{FILENAME}#%{INT}$",
        "^App directory already exists$",
        "^Archive does not contain a directory named %{NOTSPACE}$",
        "^Argument [12] passed to OCA\\%{DATA}::__construct\(\) must (be an instance of|implement interface) %{DATA}, none given, called in %{FILENAME} on line %{INT} and defined at %{FILENAME}#%{INT}$",
        "^Attempt for Paging\?  $",
        "^Bind failed: 49: Invalid credentials$",
        "^Bruteforce attempt from \"%{IP_SRC}\" detected for action \"%{DATA}\".$",
        "^CSRF check failed$",
        "^Call to a member function callForAllUsers\(\) on a non-object at %{FILENAME}#%{INT}$",
        "^Client error response \[url\] https://apps.nextcloud.com/CONTENT/content-files/%{DATA}.zip \[status code\] 400 \[reason phrase\] Bad Request$",
        "^Client error response \[url\] https://apps\.owncloud\.com/CONTENT/content-files/%{NOTSPACE} \[status code\] 400 \[reason phrase\] Bad Request$",
        "^Configuration Error \(prefix \): either no password is given for theuser agent or a password is given, but not anLDAP agent.$",
        "^Could not get applications: cURL error 28: Operation timed out after %{POSINT} milliseconds( with %{POSINT} out of %{INT} bytes received)?$",
        "^Could not read app info file for app \"%{WORD}\"$",
        "^Current user is not logged in$",
        "^Doctrine\DBAL\DBALException: Failed to connect to the database: An exception occured in driver: SQLSTATE\[HY000\] \[2002\] php_network_getaddresses: getaddrinfo failed: Name or service not known at /var/www/html/nextcloud/lib/private/DB/Connection.php#%{INT}$",
        "^Error when searching: Can't contact LDAP server code -1$",
        "^Error with getID3\. Does not seem to be a valid audio file: %{FILENAME_SRC}$",
        "^Failed to connect to the database: An exception occured in driver: SQLSTATE\[HY000\] \[2002\] php_network_getaddresses: getaddrinfo failed: Name or service not known$",
        "^Failed to connect to the database: An exception occured in driver: SQLSTATE\[HY000\] \[2005\] Unknown MySQL server host \'%{IP_DST}\' \(2\)$",
        "^HTTP\/[12]\.[10] 400 The {DAV:}property-search element must contain one {DAV:}match and one {DAV:}prop element$",
        "^HTTP\/[12]\.[10] 400 expected filesize %{INT} got %{INT}$",
        "^HTTP\/[12]\.[10] 401 Unauthorized$",
        "^HTTP\/[12]\.[10] 401 Username or password (was incorrect|does not match)$",
        "^HTTP\/[12]\.[10] 403 Requested uri \(%{DATA}\) is out of base uri \(%{DATA}\)",
        "^HTTP\/[12]\.[10] 404 File with name %{DATA:[files][dst][filename]} could not be located$",
        "^HTTP\/[12]\.[10] 404 Node with name '%{DATA}' could not be found$",
        "^HTTP\/[12]\.[10] 405 The resource you tried to create already exists$",
        "^HTTP\/[12]\.[10] 409 Parent node does not exist$",
        "^HTTP\/[12]\.[10] 412 The destination node already exists, and the overwrite header is set to false$",
        "^HTTP\/[12]\.[10] 423 \"%{DATA:[files][dst][filename]}\" is locked$",
        "^HTTP\/[12]\.[10] 500 Could not write file contents$",
        "^HTTP\/[12]\.[10] 501 There was no handler found for this \"LOCK\" method$",
        "^HTTP\/[12]\.[10] 503 Doctrine\\DBAL\\DBALFailed to connect to the database: An exception occured in driver: SQLSTATE\[HY000\] \[2005\] Unknown MySQL server host \'%{IP_DST}\' \(2\)$",
        "^HTTP\/[12]\.[10] 503 OC\\ServerNotAvailableException: Lost connection to LDAP server\.$",
        "^HTTP\/[12]\.[10] 507 Insufficient Storage$",
        "^LDAP error Invalid credentials \(49\) after calling ldap_bind$",
        "^Login failed: \'%{USER_DST}\' \(Remote IP: \'%{IP_SRC}\'\)$",
        "^Lost connection to LDAP server\.$",
        "^No update found at the ownCloud appstore for app %{NOTSPACE}$",
        "^No user available for the given login name on %{URI}$",
        "^Not in batch$",
        "^OCA\\Contacts\\Backend\\Database::getContact, Not found, id: %{INT}$",
        "^OC_Image->loadFrom(Base64|File), could not load$",
        "^PDO::__construct(): php_network_getaddresses: getaddrinfo failed: Name or service not known at /var/www/html/nextcloud/3rdparty/doctrine/dbal/lib/Doctrine/DBAL/Driver/PDOConnection.php#%{INT}$",
        "^PDO::__construct\(\): php_network_getaddresses: getaddrinfo failed: Name or service not known at /var/www/html/nextcloud/3rdparty/doctrine/dbal/lib/Doctrine/DBAL/Driver/PDOConnection\.php#%{INT}$",
        "^PDOStatement::execute\(\): Error reading result set's header at /var/www/html/nextcloud/3rdparty/doctrine/dbal/lib/Doctrine/DBAL/Driver/PDOStatement\.php#%{INT}$",
        "^PDOStatement::execute\(\): MySQL server has gone away at /var/www/html/nextcloud/3rdparty/doctrine/dbal/lib/Doctrine/DBAL/Driver/PDOStatement\.php#%{INT}$",
        "^The file \"%{FILENAME_SRC}\" with ID \"%{INT}\" has been shared to the user \"%{USER_DST}\" with permissions \"%{INT}\"  \(Share ID: %{INT}\)$",
        "^The file \"%{FILENAME_SRC}\" with ID \"%{INT}\" has been shared via link with permissions \"%{INT}\" \(Share ID: %{INT}\)$",
        "^Undefined variable: %{DATA} at %{FILENAME}#%{INT}$",
        "^Update required, skipping cron$",
        "^Updates between multiple major versions and downgrades are unsupported\.$",
        "^Version \"%{INT}\" of \"%{FILENAME_DST}\" was restored\.$",
        "^\\OC\\Files\\Filesystem::fopen\(\) failed$",
        "^file_put_contents\(%{FILENAME}\): failed to open stream: Permission denied at %{FILENAME}#%{INT}$",
        "^fopen\(%{DATA:[files][dst][filename]}\): failed to open stream: No space left on device at %{FILENAME}#%{INT}$",
        "^getGroups Filter \(&\(&\(|\(objectclass=nestedgroup\)\)\(|%{DATA}\)\)$",
        "^getGroups getGroups-%{USER_DST}-%{INT}-%{INT}$",
        "^imagecreatefromstring\(%{DATA:[files][dst][filename]}\): Couldn't create GD Image Stream out of Data at %{FILENAME}#%{INT}$",
        "^imagecreatefromstring\(%{DATA:[files][dst][filename]}\): Passed data is not in 'WBMP' format at %{FILENAME}#%{INT}$",
        "^imagecreatefromstring\(\): Empty string or invalid image at /var/www/html/nextcloud/lib/private/legacy/image\.php#%{INT}$",
        "^rename\(%{DATA:[files][dst][filename]}\): No space left on device at %{FILENAME}#%{INT}$",
        "^renaming part file to final file failed$",
        "^rmdir\(%{DATA:[files][dst][filename]}\): Directory not empty at %{FILENAME}#%{INT}$",
        "^unlink\(%{DATA:[files][dst][filename]}\): No such file or directory at /var/www/html/nextcloud/lib/private/Files/Storage/Local.php#%{INT}$",
        "^updateByPath - file not found - %{DATA:[files][dst][filename]}$"
      ] }
    }
    grok {
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Benign" ]
      match => { "message" => [
        "(m?)^initializing paged search for  ?Filter (objectClass=\*|(\(&)?\(&\(\|\(objectclass=nestedgroup\)\)\(\|(\((cn|uid)=%{DATA}\))+\)\)(\(cn=\*\))?)(\))? base Array\n\(\n\s+\[0\] => ((cn|uid)=%{DATA},)?cn=(groups|users),cn=accounts,%{SITE_LDAP_BASE}\n\)\n attr Array\n\(\n(\s+\[\d\] => %{NC_LDAP_USER_ATTRS}\n)+\)\n limit (500|2) offset 0$",
        "^(Finished|Run) %{NOTSPACE} job with ID %{INT}$",
        "^(Run|Finished) job with ID \d+$",
        "^\[DownloadService\] File to Download: %{DATA:[files][src][filename]}$",
        "^Accessing the API class is deprecated\! Use the appropriate services instead\!$",
        "^An exception occurred while executing '%{DATA}' with params \[%{DATA}\]:\n\nSQLSTATE\[23000\]: Integrity constraint violation: 1062 Duplicate entry '%{DATA}' for key '%{DATA}'$",
        "^Count filter: objectclass=*$",
        "^Expire: %{DATA:[files][dst][filename]}\.v%{INT:[files][dst][version]}$",
        "^File (accessed|created|deleted|updated|written to): \"%{DATA:[files][dst][filename]}\"$",
        "^File renamed: \"%{DATA:[files][src][filename]}\" to \"%{DATA:[files][dst][filename]}\"",
        "^Generating preview for \".+\" with \"OC\\Preview\\\w+\"$",
        "^Invalidating (remembered )?(session )?tokens older than %{TIMESTAMP_ISO8601}$",
        "^Login (attempt|successful): \"%{USER_DST}\"$",
        "^Logout occurred$",
        "^Looking for cookie L/O 500/0$",
        "^Mark to expire %{DATA:[files][dst][filename]} next version should be %{INT} or smaller\. \(prevTimestamp: %{INT}; step: %{INT}$",
        "^More than one result$",
        "^No DN found for.* on %{URI}",
        "^No paged search for us, Cpt., Limit %{INT} Offset %{INT}$",
        "^OCA\\Contacts\\Contact::setPropertyByChecksum adding: TEL( [0-9(). -]+)?$",
        "^OCA\\Contacts\\Contact::setPropertyByName adding: (FN|NOTE) .*$",
        "^OCA\\Contacts\\Hooks::contactAdded id: %{INT}$",
        "^OCA\\Contacts\\Utils\\Properties::purgeIndexes, ids: Array(\n\(\n   \[0\] => \d+\n\))?",
        "^OC_Image->fixOrientation\(\) (Orientation: -?\d+|Image is not a JPEG\.)$",
        "^OC_Image->loadFromFile, Default$",
        "^Paged search was not available$",
        "^Ready for a paged search$",
        "^Requested attribute ",
        "^Requested attribute (displayname|thumbnailphoto|jpegphoto|mail|primarygroupid) not found for uid=%{USER_DST},cn=users,cn=accounts,%{SITE_LDAP_BASE}$",
        "^Requested attribute (memberof) not found for cn=%{USER_DST},cn=groups,cn=accounts%{SITE_LDAP_BASE}$",
        "^Requested attribute .* not found for cn=.*%{SITE_LDAP_BASE}$",
        "^Rescan triggered$",
        "^Run background job \"updateGroups\"$",
        "^Version \"%{DATA:[files][dst][filename]}\" was deleted.$",
        "^Secured pdf file are currently not supported\.",
        "^The shared file with the token \"%{DATA}\" by \"%{USER_SRC}\" has been accessed\.$",
        "^Undefined offset: %{INT} at %{FILENAME}#%{INT}$",
        "^\d+ orphaned ((user|system) tag relations|comments|read marks) deleted$",
        "^\d+ orphaned comment read marks deleted$",
        "^\d+ orphaned share\(s\) deleted$",
        "^adding \d+ {\"boost\":1}$",
        "^background job (indexing \d+ files|optimizing index) for %{USER_DST}$",
        "^bgJ \"updateGroups\" – (FINISHED )?[dD]ealing with ((creat|remov)ed|known) [gG]roups\.$",
        "^bgJ \"updateGroups\" – Finished\.$",
        "^delete - \d+$",
        "^extracted metadata - artist: %{DATA}, album: audiodata, title: %{DATA}, track#: %{INT}?, year: %{INT}?, mimetype: %{DATA}, length: %{INT}, bitrate: %{INT}, fileId: %{DATA}?, this-\>userId: %{USER_DST}, userId: %{USER_DST}$",
        "^found \d+ hits for file id [ #.a-zA-Z0-9_+/-]+$",
        "^getGroups Filter (objectClass=\*|(\(&)?\(&\(\|\(objectclass=nestedgroup\)\)\(\|(\(cn=%{DATA}\))+\)\)(\(cn=\*\))?)(\))?$",
        "^getGroups getGroups--500-0?$",
        "^getGroups\(%{DATA:[files][dst][filename]}\)$",
        "^getGroups\(\): read \d+ at offset \d+ \(limit: 500\)$",
        "^getUsers: Options: search  limit 500 offset (500)? Filter: \(&\(&\(|\(objectclass=inetorgperson\)\)\(|\(memberof=cn=%{USERNAME:group_dst},cn=groups,cn=accounts,%{SITE_LDAP_BASE}\)\)\)\(displayname=\*\)\(displayname=\*\)\)$",
        "^getUsers: \d+ Users found$",
        "^imagecreatefromstring\(%{DATA:[files][dst][filename]}\): gd warning: one parameter to a memory allocation multiplication is negative or zero, failing operation gracefully$",
        "^initializing paged search for",
        "^max(X|Y) reduced from \d+ to \d+$",
        "^optimizing index$",
        "^readAttribute: ",
        "^readAttribute: cn=%{USERNAME:group_dst},cn=groups,cn=accounts,%{SITE_LDAP_BASE} found$",
        "^readAttribute: uid=%{USER_DST},cn=users,cn=accounts,%{SITE_LDAP_BASE} found$",
        "^removed \d+ files from index$",
        "^removed entities - albums: \[\], artists: \[\]$",
        "^removing \d+:[ #.a-zA-Z0-9_+/-]+ from index$",
        "^starting upgrade from [0-9.]+ to [0-9.]+$",
        "^update - [ #.a-zA-Z0-9_+/%-]+$",
        "^update - mimetype [a-zA-Z0-9-]+/[a-zA-Z0-9-]+$"
      ] }
    }
  }
  if [syslog][identifier] == "CROND" and [message] =~ /nextcloud\/cron.php\)$/ {
    grok {
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Benign" ]
      add_field => { "application" => "nextcloud" }
      match => { "message" => [ "^\(apache\) CMD \(/opt/rh/rh-php56/root/usr/bin/php -f /var/www/html/nextcloud/cron\.php\)$",
                                "^\(apache\) CMD \(/usr/bin/php -f /var/www/html/nextcloud/cron\.php\)$"
      ] }
    }
  }
}
